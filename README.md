# Short URL Service

Сервис для сокращения длинных URL-адресов, предоставляющий короткие ссылки для редиректа и собирающий статистику переходов. Пользователи могут регистрироваться для управления своими ссылками.

## Возможности:

*   **Сокращение URL:** Создание короткой ссылки для заданного длинного URL (`POST /links/shorten`).
*   **Кастомные алиасы:** Возможность указать желаемый короткий код при создании (`POST /links/shorten` с `custom_alias`).
*   **Время жизни:** Установка времени истечения срока действия для короткой ссылки (`POST /links/shorten` с `expires_at`).
*   **Редирект:** Перенаправление пользователя на оригинальный URL при переходе по короткой ссылке (`GET /{short_code}`).
*   **Управление ссылками (для владельцев):**
    *   Получение информации о ссылке.
    *   Обновление оригинального URL или параметров ссылки (`PUT /links/{short_code}`).
    *   Удаление короткой ссылки (`DELETE /links/{short_code}`).
*   **Статистика:** Просмотр статистики по ссылке (оригинальный URL, дата создания, кол-во переходов, дата последнего перехода) (`GET /links/{short_code}/stats`).
*   **Поиск:** Поиск короткой ссылки по оригинальному URL (`GET /links/search?original_url={url}`).
*   **Аутентификация:** Регистрация (`POST /auth/register`) и вход (`POST /auth/jwt/login`) пользователей для управления своими ссылками.

Запуск: 

1.  **Клонируйте репозиторий (если еще не сделали):**
    ```bash
    git clone https://github.com/zopks2/HW3_short_url
    cd HW3_short_url
    ```

2.  **Настройте переменные окружения (опционально):**
    Проект использует переменные окружения для настройки подключения к базе данных. Они определены в `docker-compose.yml` со значениями по умолчанию (`DB_USER=postgres`, `DB_PASSWORD=postgres`, `DB_NAME=postgres`, `DB_PORT=5432`).
    Если вы хотите использовать другие значения, создайте файл `.env` в корневой директории проекта (`short-url-project/.env`) и переопределите их:
    ```dotenv
    # Пример файла .env
    DB_USER=myuser
    DB_PASSWORD=mypassword
    DB_NAME=shortlinks_db
    DB_PORT=5432
    ```

3.  **Соберите образы и запустите контейнеры:**
    Эта команда соберет образ для FastAPI приложения (`web`), скачает образы PostgreSQL и Redis, создаст сеть и запустит все сервисы в фоновом режиме.
    ```bash
    docker-compose up --build -d
    ```

4.  **Примените миграции базы данных:**
    Чтобы создать необходимые таблицы в базе данных PostgreSQL, выполните команду Alembic внутри запущенного `web` контейнера:
    ```bash
    docker-compose exec web alembic upgrade head
    ```

5.  **Проверьте работу:**
    *   Приложение будет доступно по адресу `http://localhost:8008`.
    *   Документация API (Swagger UI) находится по адресу `http://localhost:8008/docs`.
